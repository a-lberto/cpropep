
\documentclass[10pt]{article}

\usepackage{vmargin}
\usepackage{amsmath}


\newcommand{\er}{\vec{e}_r}
\newcommand{\el}{\vec{e}_\lambda}
\newcommand{\eu}{\vec{e}_\mu}



\begin{document}

\section{Inertial acceleration of the vehicle mass center in body
reference frame}

Generally, the absolute acceleration of a particle $A$ in a moving
reference frame of center B is:

$$\vec{a}_A = \vec{a}_B + \vec{\alpha}\times\vec{r} +
\vec{\omega}\times(\vec{\omega}\times\vec{r})
+2\vec{\omega}\times\vec{v}_{rel} + \vec{a}_{rel}$$ 

Choosing an earth centered reference frame with constant angular
velocity ($\vec{\omega}^E$) and no acceleration yield to the simpler form

$$\vec{a}_{A_E} = \vec{\omega}^E_E\times(\vec{\omega}^E_E\times\vec{r}^E_E)
+2\vec{\omega}^E_E\times\vec{v}^{rel}_E + \vec{a}^{rel}_E$$ 

where the subscript $E$ indicate that the vector are expressed in the
earth reference frame.

Transforming this vectorial notation to matrix notation and noting
that the angular velocity of $F_B$ relative to $F_E$ is
$\vec{\omega}^B - \vec{\omega}^E$ yield to:

$$\vec{a}_{A_E} = \tilde{\omega}^E_E\tilde{\omega}^E_E\vec{r}^E_E
+2\tilde{\omega}^E_E\vec{v}^{rel}_E + \vec{a}^{rel}_E$$ 

We could now expressed this equation in term of component in the body
fixed reference frame.

$$\vec{a}_{A_B} = L_{BE}\vec{a}_{A_E} =
L_{BE}(\tilde{\omega}^E_E\tilde{\omega}^E_E\vec{r}^E_E
+2\tilde{\omega}^E_E\vec{v}^{rel}_E + \vec{a}^{rel}_E)$$ 

$$ = L_{BE}\tilde{\omega}^E_E\tilde{\omega}^E_E\vec{r}^E_E +
2L_{BE}\tilde{\omega}^E_E\vec{v}^{rel}_E + (\tilde{\omega}^B -
\tilde{\omega}^E)_B\vec{v}^{rel}_B + \vec{a}^{rel}_B$$


We could then transform

$$L_{BE}\tilde{\omega}^E_E\vec{v}^{rel}_E = (L_{BE}\tilde{\omega}^E_E
L_{EB})(L_{BE}\vec{v}^{rel}_E) = \tilde{\omega}^E_B\vec{v}^{rel}_B$$

and

$$L_{BE}\tilde{\omega}^E_E\tilde{\omega}^E_E\vec{r}^E_E =
(L_{BE}\tilde{\omega}^E_E L_{EB})(L_{BE}\tilde{\omega}^E_E
L_{EB})(L_{BE}\vec{r}^E_E) =
\tilde{\omega}^E_B\tilde{\omega}^E_B\vec{r}^E_B$$ 

We now have

$$\vec{a}_{A_B} = \vec{a}^{rel}_B + (\tilde{\omega}^B -
\tilde{\omega}^E)_B\vec{v}^E_B +
\tilde{\omega}^E_B\tilde{\omega}^E_B\vec{r}^E_B +
2\tilde{\omega}^E_B\vec{v}^{rel}_B$$ 

which simplify to

$$\vec{a}_{A_B} = \vec{a}^{rel}_B + (\tilde{\omega}^B +
\tilde{\omega}^E)_B\vec{v}^E_B +
\tilde{\omega}^E_B\tilde{\omega}^E_B\vec{r}^E_B$$ 


Defining vector component in $F_B$

$$\vec{v}^E_B = \begin{bmatrix}u\\v\\w\end{bmatrix}$$
$$\vec{\omega}^B_B = \begin{bmatrix}p\\q\\r\end{bmatrix}$$
$$\vec{\omega}^E_B = \begin{bmatrix}p^E_B\\q^E_B\\r^E_B\end{bmatrix} =
L_{BV}\begin{pmatrix}\cos{\lambda}\\0\\-\sin{\lambda}\end{pmatrix}\omega^E$$

and matrix notation of angular velocity

$$\tilde{\omega}^B_B =
\begin{bmatrix}0&-r&q\\r&0&-p\\q&p&0\end{bmatrix}$$

$$\tilde{\omega}^E_B =
\begin{bmatrix}0&-r^E_B&q^E_B\\r^E_B&0&-p^E_B\\q^E_B&p^E_B&0\end{bmatrix}$$


\section{Acceleration of vehicle mass center espressed in a spherical
coordinate system relative to rotating earth}

The spherical coordinate system is compose of the three vector
($\er$, $\el$, $\eu$), where $\er$ point in the direction of the mass
center of the vehicle, $\el$ point in the north direction and is
perpendicular to $\er$, $\eu$ point east and is perpendicular to both
previous vectors. We could also define the direction of $\er$ with two
angle, $\mu$ is the angle between the equatorial projection of $\er$
and a reference meridian on the earth. $\lambda$ is the angle between
$\er$ and the equator. We could then define the relative velocity and
acceleration of the point C relative to earth by:

$$\vec{v}_{rel} = \dot{r}\er + r\dot{\mu}\cos{\lambda}\eu + r\dot{\lambda}\el$$

\begin{align*}
\vec{a}_{rel} = & (\ddot{r} - r\dot{\lambda}^2 -
                  r\dot{\mu}^2\cos^2{\lambda})\er +\\ 
                &  ((2\dot{r}\dot{\mu} + r\ddot{\mu})\cos{\lambda} -
                  2r\dot{\mu}\dot{\lambda}\sin{\lambda})\eu +\\
                &  (2\dot{r}\dot{\lambda} + r\ddot{\lambda} +
                  r\dot{\mu}^2\sin{\lambda}\cos{\lambda})\el
\end{align*}


We can now derive the inertial velocity and acceleration of C:

\begin{align*}
\vec{v}_C & = \vec{v}_O + \vec{v}_{rel} + \vec{\omega}\times\vec{r}\\
          & = \dot{r}\er + r\dot{\mu}\cos{\lambda}\eu +
              r\dot{\lambda}\el + \omega\vec{k}\times r\er\\
          & = \dot{r}\er + r\cos{\lambda}(\dot{\mu} + \omega)\eu 
              + r\dot{\lambda}\el 
\end{align*}

$$\vec{a}_C = \vec{a}_O + \vec{\alpha}\times\vec{r} +
              \vec{\omega}\times(\vec{\omega}\times\vec{r})
              +2\vec{\omega}\times\vec{v}_{rel} + \vec{a}_{rel}$$

Each term will be evaluate separatly:

\begin{align*}
\vec{\omega}\times(\vec{\omega}\times\vec{r}) & =
      \omega\vec{k}\times(\omega\vec{k}\times r\er)\\
    & = \omega\vec{k}\times(\omega r\cos{\lambda}\eu)\\
    & = \omega^2r\cos{\lambda}(-\cos{\lambda}\er+\sin{\lambda}\el)\\
    & = -\omega^2r\cos^2{\lambda}\er + \omega^2r\cos{\lambda}\sin{\lambda}\el
\end{align*}

\begin{align*}
\vec{\omega}\times\vec{v}_{rel} & = \omega\vec{k}\times(\dot{r}\er +
    r\dot{\mu}\cos{\lambda}\eu + r\dot{\lambda}\el)\\
 & = \omega\dot{r}\cos{\lambda}\eu + \omega
     r\dot{\mu}\cos{\lambda}(-\cos{\lambda}\er + \sin{\lambda}\el) +
     \omega r\dot{\lambda}(-\cos{\lambda})\eu\\
 & = \omega\cos{\lambda}(\dot{r}-r\dot{\lambda})\eu - \omega
 r\dot{\mu}\cos^2{\lambda}\er + \omega r\dot{\mu}\cos{\lambda}\sin{\lambda}\el
\end{align*}


The inertial acceleration of C is then:

\begin{align*}
\vec{a}_C = &   (\ddot{r} - r\dot{\lambda}^2 -
                r\dot{\mu}^2\cos^2{\lambda} - 2\omega
                r\dot{\mu}\cos^2{\lambda} - \omega^2r\cos^2{\lambda})\er\\ 
            & + ((2\dot{r}\dot{\mu} + r\ddot{\mu})\cos{\lambda} -
                2r\dot{\mu}\dot{\lambda}\sin{\lambda}
              + 2\omega\cos{\lambda}(\dot{r}-r\dot{\lambda})\eu\\
            & + (2\dot{r}\dot{\lambda} + r\ddot{\lambda} +
                r\dot{\mu}^2\sin{\lambda}\cos{\lambda} +2\omega
                r\dot{\mu}\cos{\lambda}\sin{\lambda} +
                \omega^2r\cos{\lambda}\sin{\lambda})\el
\end{align*}

which simplify to:
\begin{align*}
\vec{a}_C = &   (\ddot{r} - r\dot{\lambda}^2 -
	        r(\omega+\dot{\mu})^2\cos^2{\lambda})\er\\ 
            & + ((2\dot{r}\dot{\mu} + r\ddot{\mu})\cos{\lambda} -
                2r\dot{\mu}\dot{\lambda}\sin{\lambda}
              + 2\omega\cos{\lambda}(\dot{r}-r\dot{\lambda})\eu\\
            & + (2\dot{r}\dot{\lambda} + r\ddot{\lambda} +
	        r\sin{\lambda}\cos{\lambda}(\omega+\dot{\mu})^2)\el
\end{align*}


We must now project the inertial acceleration from this vehicled
carried frame to the bidy fixed frame with the conversion matrix based
on the euler angle which define the angular position of $F_B$ relative
to $F_V$.

$$L_{BV} = \begin{bmatrix} \cos{\theta}\cos{\psi}&
                         \cos{\theta}\sin{\psi}& -\sin{\theta}\\
                         \sin{\phi}\sin{\theta}\cos{\psi}-\cos{\phi}\sin{\psi}&
                         \sin{\phi}\sin{\theta}\sin{\psi}+\cos{\phi}\cos{\psi}&
                         \sin{\phi}\cos{\theta}\\
                         \cos{\phi}\sin{\theta}\cos{\psi}+\sin{\phi}\sin{\psi}&
                         \cos{\phi}\sin{\theta}\sin{\psi}-\sin{\phi}\cos{\psi}&
                         \cos{\phi}\cos{\theta}
         \end{bmatrix}
$$

\begin{align*}
\vec{a}_{C_B} & = L_{BV}\vec{a}_C\\
              & = L_{BV}(\vec{\omega}\times(\vec{\omega}\times\vec{r})
                + 2\vec{\omega}\times\vec{v}_{rel} + \vec{a}_{rel})\\
              & = L_{BV}\begin{bmatrix}r\cos{\lambda}\sin{\lambda}\\ 0\\
                  -r\cos^2{\lambda}\end{bmatrix}\omega^2  +
                2\vec{\omega}^E_B\times\vec{v}_{rel_B} +
                \vec{a}_{rel_B} + (\vec{\omega}^B -
                \vec{\omega}^E)_B\times\vec{v}^E_B \\
              & =  L_{BV}\begin{bmatrix}r\cos{\lambda}\sin{\lambda}\\ 0\\
                  -r\cos^2{\lambda}\end{bmatrix}\omega^2  +
                \vec{a}_{rel_B} + (\vec{\omega}^B +
                \vec{\omega}^E)_B\times\vec{v}^E_B\\
              & = \begin{bmatrix}\dot{u}\\\dot{v}\\\dot{w}\end{bmatrix} + 
                  \begin{bmatrix}c_x\\c_y\\c_z\end{bmatrix} + 
                  \begin{bmatrix}(q + q^E_B)w - (r + r^E_B)v\\
                                 (r + r^E_B)u - (p + p^E_B)w\\
                                 (p + p^E_B)v - (q + q^E_B)u\end{bmatrix}
\end{align*}



We will also use the moment equation:

\begin{align*}
L & = I_x\dot{p} - (I_y - I_z)qr\\
M & = I_y\dot{q} - (I_z - I_x)rp\\
N & = I_z\dot{r} - (I_x - I_y)pq
\end{align*}


\section{System of equation}

\subsection{Independant variable}

\begin{align*}
(\phi, \theta, \psi)\quad & \text{Euler angle defining orientation of the
vehicle relative to $F_V$}\\
(u, v, w)\quad & \text{Velocity of the vehicle relative to earth}\\
(p, q, r)\quad & \text{Absolute angle rate}\\
(\lambda, \mu, R)\quad & \text{Position of the rocket relative to earth}\\
(p^E_B, q^E_B, r^E_B)\quad & \text{Earth angular velocity in body axis}\\
(P, Q, R) \quad & \text{Relative angular velocity of body relative ro $F_V$
expressed in $F_B$}
\end{align*}

\subsection{List of equations}

$$X - mg\sin{\theta} = m(\dot{u} + c_x + (q^E_B+q)w - (r^E_B+r)v)$$
$$Y + mg\cos{\theta}\sin{\phi} = m(\dot{v} + c_y + (r^E_B+r)u - (p^E_B+p)w)$$
$$Z + mg\cos{\theta}\cos{\phi} = m(\dot{w} + c_z + (p^E_B+pvw -
(q^E_B+q)u)$$

\begin{align*}
L & = I_x\dot{p} - (I_y - I_z)qr\\
M & = I_y\dot{q} - (I_z - I_x)rp\\
N & = I_z\dot{r} - (I_x - I_y)pq
\end{align*}

$$\begin{bmatrix}\dot{\phi}\\\dot{\theta}\\\dot{\psi}\end{bmatrix} = 
  \begin{bmatrix}1&\sin{\phi}\tan{\theta}&\cos{\phi}\tan{\theta}\\
                 0&\cos{\phi}&-\sin{\phi}\\
                 0&\sin{\phi}\sec{\theta}&\cos{\phi}\sec{\theta}\end{bmatrix}
  \begin{bmatrix}P\\Q\\R\end{bmatrix}$$


$$\begin{bmatrix}P\\Q\\R\end{bmatrix} =
  \begin{bmatrix}p\\q\\r\end{bmatrix} - 
  L_{BV}\begin{bmatrix}(\omega^E -
 \dot{\mu})\cos{\lambda}\\-\dot{\lambda}\\
 -(\omega^E + \dot{\mu})\sin{\lambda}\end{bmatrix}$$

$$\begin{bmatrix}r\dot{\lambda}\\r\dot{\mu}\cos{\lambda}\\\dot{r}
  \end{bmatrix} = L_{VB}\begin{bmatrix}u\\v\\w\end{bmatrix}$$

$$\vec{\omega}^E_B = \begin{bmatrix}p^E_B\\q^E_B\\r^E_B\end{bmatrix} =
L_{BV}\begin{pmatrix}\cos{\lambda}\\0\\-\sin{\lambda}\end{pmatrix}\omega^E$$


$$L_{VB} = \begin{bmatrix}\cos{\theta}\cos{\psi}&
             \sin{\phi}\sin{\theta}\cos{\psi} - \cos{\phi}\sin{\psi}&
             \cos{\phi}\sin{\theta}\cos{\psi} + \sin{\phi}\sin{\psi}\\
             \cos{\theta}\sin{\psi}&
             \sin{\phi}\sin{\theta}\sin{\psi} + \cos{\phi}\cos{\psi}&
             \cos{\phi}\sin{\theta}\sin{\psi} - \sin{\phi}\cos{\psi}\\
             -\sin{\theta}&
             \sin{\phi}\cos{\theta}&
             \cos{\phi}\cos{\theta}\end{bmatrix}$$

\end{document}            



